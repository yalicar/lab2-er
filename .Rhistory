plot(density(df$hr),main="Funcion de densidad por hora")
df <- as.data.frame(read.csv(file = "./hour.csv"))
class(df)
library(dplyr)
paste("El mes que tiende mayor demanda es el mes #",(df %>% group_by(mnth) %>% summarise(cnt = sum(cnt)) %>% top_n(1,cnt))$mnth, "con",(df %>% group_by(mnth) %>% summarise(cnt = sum(cnt)) %>% top_n(1,cnt))$cnt,"alquileres" )
df %>% group_by(group = cut(hr, breaks = seq(0, max(hr), 2))) %>% summarise(cnt = sum(cnt)) %>% top_n(1,cnt)
df %>% group_by(season) %>% summarise(cnt = sum(cnt)) %>% top_n(1,cnt)
df_t=df %>% group_by(temp) %>% summarise(cnt = sum(cnt))
mean(df_t$cnt) ## Calculo de la media.
library(ggplot2)
ggplot(df_t, aes(x=temp, y=cnt )) +
geom_line(colour="red")  +
geom_point( size=2, shape=21, fill="white", colour="red") +
geom_hline(yintercept = mean(df_t$cnt),size = 1) +
geom_text(aes(0,mean(cnt) ,label = "Media =", vjust = -1)) +
geom_text(aes(0.12,mean(cnt) ,label = mean(cnt), vjust = -1)) +
theme_minimal()
paste("Valor minimo de temperaratura a partir de donde baja la demanda es",min(filter(df_t, cnt >= mean(df_t$cnt))$temp) )
paste("Valor maximo de temperaratura a partir de donde baja la demanda es",max(filter(df_t, cnt >= mean(df_t$cnt))$temp) )
df_t=df %>% group_by(hum) %>% summarise(cnt = sum(cnt))
mean(df_t$cnt) ## Calculo de la media.
ggplot(df_t, aes(x=hum, y=cnt )) +
geom_line(colour="red")  +
geom_point( size=2, shape=21, fill="white", colour="red") +
geom_hline(yintercept = mean(df_t$cnt),size = 1) +
geom_text(aes(0,mean(cnt) ,label = "Media =", vjust = -1)) +
geom_text(aes(0.16,mean(cnt) ,label = mean(cnt), vjust = -1)) +
theme_minimal()+xlab("Humedad")
paste("Valor minimo de temperaratura a partir de donde baja la demanda con respecto a la media es",min(filter(df_t, cnt>= mean(df_t$cnt))$hum) )
plot(density((subset(df, season==1))$cnt),col="green",main="Densidades segun estacion")
lines(density((subset(df, season==2))$cnt),col="orange")
lines(density((subset(df, season==3))$cnt),col="brown")
lines(density((subset(df, season==4))$cnt),col="blue")
plot(density(df$cnt))
paste("Proedio de personas que rentan bicicletas y estan registradas es",mean(df$registered))
df %>%
group_by(season) %>%
summarise_at(vars(registered), list(registered = mean))
paste(" La mediana de las personas que no estan resgistradas y rentan bicicletas es:",median(df$casual))
df %>% group_by(weathersit) %>% summarise(cnt = sum(cnt))
df %>%
group_by(weathersit) %>%
summarise_at(vars(cnt), list(cnt = mean))
library(ggplot2)
ggplot(data=df %>% group_by(season) %>% summarise(registered = sum(registered)), aes(x=season, y=registered)) +
ggtitle("Plot of Registered Cliente vs Season ")+
geom_bar(stat="identity", width = 0.5, fill="steelblue")+
geom_point( size=2, shape=21, fill="white", colour="red") +
theme_minimal()
ggplot(data=df %>% group_by(season) %>% summarise(registered = sum(casual)), aes(x=season, y=registered)) +
ggtitle("Plot of Casual Cliente vs Season ")+
geom_bar(stat="identity", width = 0.5, fill="steelblue")+
geom_point( size=2, shape=21, fill="white", colour="red") +
theme_minimal()
plot(density(df$hr),main="Funcion de densidad por hora")
library(dplyr)
df<- mutate(df,dtedaymth=day(df$dteday))
df <- as.data.frame(read.csv(file = "./hour.csv"))
class(df)
library(dplyr)
paste("El mes que tiende mayor demanda es el mes #",(df %>% group_by(mnth) %>% summarise(cnt = sum(cnt)) %>% top_n(1,cnt))$mnth, "con",(df %>% group_by(mnth) %>% summarise(cnt = sum(cnt)) %>% top_n(1,cnt))$cnt,"alquileres" )
df %>% group_by(group = cut(hr, breaks = seq(0, max(hr), 2))) %>% summarise(cnt = sum(cnt)) %>% top_n(1,cnt)
df %>% group_by(season) %>% summarise(cnt = sum(cnt)) %>% top_n(1,cnt)
df_t=df %>% group_by(temp) %>% summarise(cnt = sum(cnt))
mean(df_t$cnt) ## Calculo de la media.
library(ggplot2)
ggplot(df_t, aes(x=temp, y=cnt )) +
geom_line(colour="red")  +
geom_point( size=2, shape=21, fill="white", colour="red") +
geom_hline(yintercept = mean(df_t$cnt),size = 1) +
geom_text(aes(0,mean(cnt) ,label = "Media =", vjust = -1)) +
geom_text(aes(0.12,mean(cnt) ,label = mean(cnt), vjust = -1)) +
theme_minimal()
paste("Valor minimo de temperaratura a partir de donde baja la demanda es",min(filter(df_t, cnt >= mean(df_t$cnt))$temp) )
paste("Valor maximo de temperaratura a partir de donde baja la demanda es",max(filter(df_t, cnt >= mean(df_t$cnt))$temp) )
df_t=df %>% group_by(hum) %>% summarise(cnt = sum(cnt))
mean(df_t$cnt) ## Calculo de la media.
ggplot(df_t, aes(x=hum, y=cnt )) +
geom_line(colour="red")  +
geom_point( size=2, shape=21, fill="white", colour="red") +
geom_hline(yintercept = mean(df_t$cnt),size = 1) +
geom_text(aes(0,mean(cnt) ,label = "Media =", vjust = -1)) +
geom_text(aes(0.16,mean(cnt) ,label = mean(cnt), vjust = -1)) +
theme_minimal()+xlab("Humedad")
paste("Valor minimo de temperaratura a partir de donde baja la demanda con respecto a la media es",min(filter(df_t, cnt>= mean(df_t$cnt))$hum) )
plot(density((subset(df, season==1))$cnt),col="green",main="Densidades segun estacion")
lines(density((subset(df, season==2))$cnt),col="orange")
lines(density((subset(df, season==3))$cnt),col="brown")
lines(density((subset(df, season==4))$cnt),col="blue")
plot(density(df$cnt))
paste("Proedio de personas que rentan bicicletas y estan registradas es",mean(df$registered))
df %>%
group_by(season) %>%
summarise_at(vars(registered), list(registered = mean))
paste(" La mediana de las personas que no estan resgistradas y rentan bicicletas es:",median(df$casual))
df %>% group_by(weathersit) %>% summarise(cnt = sum(cnt))
df %>%
group_by(weathersit) %>%
summarise_at(vars(cnt), list(cnt = mean))
library(ggplot2)
ggplot(data=df %>% group_by(season) %>% summarise(registered = sum(registered)), aes(x=season, y=registered)) +
ggtitle("Plot of Registered Cliente vs Season ")+
geom_bar(stat="identity", width = 0.5, fill="steelblue")+
geom_point( size=2, shape=21, fill="white", colour="red") +
theme_minimal()
ggplot(data=df %>% group_by(season) %>% summarise(registered = sum(casual)), aes(x=season, y=registered)) +
ggtitle("Plot of Casual Cliente vs Season ")+
geom_bar(stat="identity", width = 0.5, fill="steelblue")+
geom_point( size=2, shape=21, fill="white", colour="red") +
theme_minimal()
plot(density(df$hr),main="Funcion de densidad por hora")
library(dplyr)
df<- mutate(df,dtedaymth=day(df$dteday))
